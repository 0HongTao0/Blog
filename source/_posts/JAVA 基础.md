title: JAVA 基础
date: 2018-11-30 14.00
tags:

------

### JAVA 并发

- 如何创建多线程？

  主要有 2 种方法

  1. 创建一个子类继承（extends） Thread 类，然后重写 run（）方法。
  2. 创建一个子类实现（implement）Runnable 接口，然后重写 run（）方法。

- 简述线程的五种状态

  1. 线程的五种状态分别是：新建（New），就绪（Runnable），运行（Running），终止（Dead），阻塞（Blocked）

  2. 线程没被阻塞从新建状态到终止状态的过程：从线程被 new 创建开始，线程就进入**新建**状态，当程序调用 Thread.start() 方法的时候，线程进入**就绪**状态，因为 JAVA 线程的调度是抢占式调度，所以在这个时候线程有可能正在运行也可能没有运行，当操作系统分配时间片给线程的时候，线程进入**运行**状态，当 Thread.run() 方法执行到最后一条语句并返回的时候，线程自然死亡，进入**终止**状态。

  3. 线程被阻塞即从**就绪**状态转至**阻塞**状态，导致线程进入阻塞状态的原因主要有 3 个，**同步阻塞**，当线程获取一个被其他线程所持有的对象锁，线程进入阻塞状态。线程执行 **Thread.sleep()** 方法，以及 **Thread.wait()** 方法。当线程在阻塞状态被激活的时候，线程进入**就绪**状态，等待系统调度进入**运行**状态。

     ![img](https://upload-images.jianshu.io/upload_images/5545289-1c4500c4a5adaafe.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/527/format/webp)

- 如何中断正在执行的线程

  1. 执行完 run（）方法的最后一条语句并由 return 返回时，线程终止。
  2. 当线程run（）方法种出现了没有捕获分异常时，线程终止。

  没有方法可以强制终止线程，但是可以用 Thread.interrupt() 方法来请求终止线程。线程有个中断状态的 Boolean 标志，不停地检查该标志，线程阻塞无法检查中断状态所以不能在线程阻塞的时候调用 Thread.interrupt() 方法（会抛出 InterruptedException）。

- 锁的相关理解

  1. 锁是防止程序代码块中受并发访问而造成不安全的干扰，即保证任何时刻只能有一个线程执行被保护的代码。
  2. 大多数情况下是通过 synchronized 关键字来实现锁，在 JAVA 中每一个对象都存在一个锁，**synchronized 用在方法上**，是锁住当前对象的当前方法，多个线程访问这个对象的该方法会被阻塞；**synchronized(this)** 锁住的是当前对象的，多个线程访问这个对象会被阻塞；同理可得 **synchronized(object)** 锁的是 object 对象，多个线程访问该对象会被阻塞；（注意：锁的对象不能是 final 类，因为经过修改的 final 类会是一个新对象，无法获取同一个锁）
  3. 也可以通过 JAVA 提供的 Lock 类来实现锁。
